const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/wordsCache-ByHSZrui-yaSILgvz.js","assets/wordsCache-BZ4gcfdz-BnHwzGpD.js"])))=>i.map(i=>d[i]);
import{C as e,a as t,b as n,c as r,d as i,g as a,h as o,i as s,n as c,p as l,s as u,t as d,w as f}from"./index-2NryKbWx.js";import{a as p,r as m}from"./wordsCache-BZ4gcfdz-BnHwzGpD.js";import{t as h}from"./Header-BrePaYqJ-CupKeyHn.js";var g=(e,t=g,n=t.f||=[`assets/wordsCache-ByHSZrui.js`,`assets/wordsCache-BZ4gcfdz.js`])=>e.map(e=>n[e]),_={footer:`_footer_1m1ug_1`,exitButton:`_exitButton_1m1ug_8`},v=f(),y=()=>{let{t:e}=n();return(0,v.jsx)(`footer`,{className:_.footer,children:(0,v.jsx)(h,{onClick:async()=>{try{await s(c)}catch(e){console.error(`Ошибка выхода:`,e)}},icon:`pi pi-sign-out`,label:e(`exitAccount`),className:_.exitButton})})},b={cardContainer:`_cardContainer_1rm64_1`,card:`_card_1rm64_1`,cardInner:`_cardInner_1rm64_21`,flipped:`_flipped_1rm64_29`,cardFront:`_cardFront_1rm64_33`,cardBack:`_cardBack_1rm64_34`,word:`_word_1rm64_58`,translations:`_translations_1rm64_64`,translation:`_translation_1rm64_64`,langLabel:`_langLabel_1rm64_77`,translationText:`_translationText_1rm64_83`,actions:`_actions_1rm64_88`,editButton:`_editButton_1rm64_97`,deleteButton:`_deleteButton_1rm64_98`},x=e(),S=({wordKey:e,wordData:t,wordId:r,onEdit:i,onDelete:a,showActions:o=!1})=>{let{t:s,i18n:c}=n(),[l,u]=(0,x.useState)(!1),d=()=>{u(!l)},f,p={};if(t)f=t[c.language||`en`]||``,p=t.translations||{};else if(e){f=s(`words.${e}.${c.language||`en`}`);let t=s(`words.${e}.translations`,{returnObjects:!0});p=typeof t==`object`&&t?t:{}}else f=``;let m=e=>{e.stopPropagation(),r&&t&&i&&i(r,t)},h=e=>{e.stopPropagation(),r&&a&&a(r)};return(0,v.jsxs)(`div`,{className:b.cardContainer,children:[o&&r&&(0,v.jsxs)(`div`,{className:b.actions,onClick:e=>e.stopPropagation(),children:[i&&t&&(0,v.jsx)(`button`,{className:b.editButton,onClick:m,"aria-label":s(`edit`),children:(0,v.jsx)(`i`,{className:`pi pi-pencil`})}),a&&(0,v.jsx)(`button`,{className:b.deleteButton,onClick:h,"aria-label":s(`delete`),children:(0,v.jsx)(`i`,{className:`pi pi-times`})})]}),(0,v.jsx)(`div`,{className:b.card,onClick:d,children:(0,v.jsxs)(`div`,{className:`${b.cardInner} ${l?b.flipped:``}`,children:[(0,v.jsx)(`div`,{className:b.cardFront,children:(0,v.jsx)(`div`,{className:b.word,children:f||e||``})}),(0,v.jsx)(`div`,{className:b.cardBack,children:(0,v.jsx)(`div`,{className:b.translations,children:Object.entries(p).map(([e,t])=>(0,v.jsxs)(`div`,{className:b.translation,children:[(0,v.jsxs)(`span`,{className:b.langLabel,children:[e.toUpperCase(),`:`]}),(0,v.jsx)(`span`,{className:b.translationText,children:t})]},e))})})]})})]})},C=6e4,w=3e5,T=async e=>{if(!c.currentUser||c.currentUser.uid!==e)return null;try{let{loadWordsFromCache:n}=await o(async()=>{let{loadWordsFromCache:e}=await a(async()=>{let{loadWordsFromCache:e}=await import(`./wordsCache-ByHSZrui-yaSILgvz.js`);return{loadWordsFromCache:e}},__vite__mapDeps([0,1]));return{loadWordsFromCache:e}},g([0,1])),s=n(e)||[],c=new Map,f=[];s.forEach(e=>{e.id.startsWith(`temp_`)?f.push(e):c.set(e.id,e)});let p=await i(t(u(d,`words`),r(`userId`,`==`,e),l(`createdAt`,`desc`))),h=new Map;p.forEach(e=>{let t={id:e.id,...e.data()};h.set(e.id,t)});let _=[];return f.forEach(e=>{let t=Array.from(h.values()).find(t=>t.ru===e.ru&&t.en===e.en&&t.ko===e.ko);t?(_.push(t),h.delete(t.id)):_.push(e)}),h.forEach(e=>{_.push(e)}),_.sort((e,t)=>{let n=e.createdAt instanceof Date?e.createdAt.getTime():typeof e.createdAt==`number`?e.createdAt:e.createdAt?new Date(e.createdAt).getTime():0;return(t.createdAt instanceof Date?t.createdAt.getTime():typeof t.createdAt==`number`?t.createdAt:t.createdAt?new Date(t.createdAt).getTime():0)-n}),m(e,_),_}catch(e){return console.error(`Ошибка синхронизации слов с сервером:`,e),null}},E=e=>{try{let t=p(e),n=localStorage.getItem(t);return n?Date.now()-Number.parseInt(n,10)>w:!0}catch(e){return console.error(`Ошибка проверки необходимости синхронизации:`,e),!0}},D=(e,t)=>{let n=null,r=!1,i=async()=>{if(!(r||!c.currentUser||c.currentUser.uid!==e)){r=!0;try{let n=await T(e);n&&t&&t(n)}catch(e){console.error(`Ошибка периодической синхронизации:`,e)}finally{r=!1}}},a=()=>{document.visibilityState===`visible`&&E(e)&&i()},o=()=>{E(e)&&i()};return E(e)&&i(),n=setInterval(()=>{E(e)&&i()},C),document.addEventListener(`visibilitychange`,a),window.addEventListener(`focus`,o),()=>{n&&clearInterval(n),document.removeEventListener(`visibilitychange`,a),window.removeEventListener(`focus`,o)}};export{S as i,D as n,y as r,T as t};
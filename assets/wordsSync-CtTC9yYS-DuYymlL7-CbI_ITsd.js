const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/wordsCache-ByHSZrui-yaSILgvz-7J9T3Ht2.js","assets/wordsCache-BZ4gcfdz-BnHwzGpD-D8q4o8UH.js"])))=>i.map(i=>d[i]);
import{C as e,E as t,T as n,b as r,c as i,d as a,n as o,p as s,r as c,s as l,t as u,u as d,w as f,y as p}from"./index-DiG2Dxd6.js";import{a as m,r as h}from"./wordsCache-BZ4gcfdz-BnHwzGpD-D8q4o8UH.js";import{t as g}from"./Header-BrePaYqJ-CupKeyHn-CUyZQLGM.js";var _=(e,t=_,n=t.f||=[`assets/wordsCache-ByHSZrui-yaSILgvz.js`,`assets/wordsCache-BZ4gcfdz-BnHwzGpD.js`])=>e.map(e=>n[e]),v=(e,t=v,n=t.f||=[`assets/wordsCache-ByHSZrui.js`,`assets/wordsCache-BZ4gcfdz.js`])=>e.map(e=>n[e]),y={footer:`_footer_1m1ug_1`,exitButton:`_exitButton_1m1ug_8`},b=e(),x=()=>{let{t:e}=n();return(0,b.jsx)(`footer`,{className:y.footer,children:(0,b.jsx)(g,{onClick:async()=>{try{await u(i)}catch(e){console.error(`Ошибка выхода:`,e)}},icon:`pi pi-sign-out`,label:e(`exitAccount`),className:y.exitButton})})},S={cardContainer:`_cardContainer_1rm64_1`,card:`_card_1rm64_1`,cardInner:`_cardInner_1rm64_21`,flipped:`_flipped_1rm64_29`,cardFront:`_cardFront_1rm64_33`,cardBack:`_cardBack_1rm64_34`,word:`_word_1rm64_58`,translations:`_translations_1rm64_64`,translation:`_translation_1rm64_64`,langLabel:`_langLabel_1rm64_77`,translationText:`_translationText_1rm64_83`,actions:`_actions_1rm64_88`,editButton:`_editButton_1rm64_97`,deleteButton:`_deleteButton_1rm64_98`},C=a(),w=({wordKey:e,wordData:t,wordId:r,onEdit:i,onDelete:a,showActions:o=!1})=>{let{t:s,i18n:c}=n(),[l,u]=(0,C.useState)(!1),d=()=>{u(!l)},f,p={};if(t)f=t[c.language||`en`]||``,p=t.translations||{};else if(e){f=s(`words.${e}.${c.language||`en`}`);let t=s(`words.${e}.translations`,{returnObjects:!0});p=typeof t==`object`&&t?t:{}}else f=``;let m=e=>{e.stopPropagation(),r&&t&&i&&i(r,t)},h=e=>{e.stopPropagation(),r&&a&&a(r)};return(0,b.jsxs)(`div`,{className:S.cardContainer,children:[o&&r&&(0,b.jsxs)(`div`,{className:S.actions,onClick:e=>e.stopPropagation(),children:[i&&t&&(0,b.jsx)(`button`,{className:S.editButton,onClick:m,"aria-label":s(`edit`),children:(0,b.jsx)(`i`,{className:`pi pi-pencil`})}),a&&(0,b.jsx)(`button`,{className:S.deleteButton,onClick:h,"aria-label":s(`delete`),children:(0,b.jsx)(`i`,{className:`pi pi-times`})})]}),(0,b.jsx)(`div`,{className:S.card,onClick:d,children:(0,b.jsxs)(`div`,{className:`${S.cardInner} ${l?S.flipped:``}`,children:[(0,b.jsx)(`div`,{className:S.cardFront,children:(0,b.jsx)(`div`,{className:S.word,children:f||e||``})}),(0,b.jsx)(`div`,{className:S.cardBack,children:(0,b.jsx)(`div`,{className:S.translations,children:Object.entries(p).map(([e,t])=>(0,b.jsxs)(`div`,{className:S.translation,children:[(0,b.jsxs)(`span`,{className:S.langLabel,children:[e.toUpperCase(),`:`]}),(0,b.jsx)(`span`,{className:S.translationText,children:t})]},e))})})]})})]})},T=6e4,E=3e5,D=async e=>{if(!i.currentUser||i.currentUser.uid!==e)return null;try{let{loadWordsFromCache:n}=await c(async()=>{let{loadWordsFromCache:e}=await p(async()=>{let{loadWordsFromCache:e}=await t(async()=>{let{loadWordsFromCache:e}=await import(`./wordsCache-ByHSZrui-yaSILgvz-7J9T3Ht2.js`);return{loadWordsFromCache:e}},__vite__mapDeps([0,1]));return{loadWordsFromCache:e}},_([0,1]));return{loadWordsFromCache:e}},v([0,1])),i=n(e)||[],a=new Map,u=[];i.forEach(e=>{e.id.startsWith(`temp_`)?u.push(e):a.set(e.id,e)});let m=await d(o(s(f,`words`),r(`userId`,`==`,e),l(`createdAt`,`desc`))),g=new Map;m.forEach(e=>{let t={id:e.id,...e.data()};g.set(e.id,t)});let y=[];return u.forEach(e=>{let t=Array.from(g.values()).find(t=>t.ru===e.ru&&t.en===e.en&&t.ko===e.ko);t?(y.push(t),g.delete(t.id)):y.push(e)}),g.forEach(e=>{y.push(e)}),y.sort((e,t)=>{let n=e.createdAt instanceof Date?e.createdAt.getTime():typeof e.createdAt==`number`?e.createdAt:e.createdAt?new Date(e.createdAt).getTime():0;return(t.createdAt instanceof Date?t.createdAt.getTime():typeof t.createdAt==`number`?t.createdAt:t.createdAt?new Date(t.createdAt).getTime():0)-n}),h(e,y),y}catch(e){return console.error(`Ошибка синхронизации слов с сервером:`,e),null}},O=e=>{try{let t=m(e),n=localStorage.getItem(t);return n?Date.now()-Number.parseInt(n,10)>E:!0}catch(e){return console.error(`Ошибка проверки необходимости синхронизации:`,e),!0}},k=(e,t)=>{let n=null,r=!1,a=async()=>{if(!(r||!i.currentUser||i.currentUser.uid!==e)){r=!0;try{let n=await D(e);n&&t&&t(n)}catch(e){console.error(`Ошибка периодической синхронизации:`,e)}finally{r=!1}}},o=()=>{document.visibilityState===`visible`&&O(e)&&a()},s=()=>{O(e)&&a()};return O(e)&&a(),n=setInterval(()=>{O(e)&&a()},T),document.addEventListener(`visibilitychange`,o),window.addEventListener(`focus`,s),()=>{n&&clearInterval(n),document.removeEventListener(`visibilitychange`,o),window.removeEventListener(`focus`,s)}};export{x as i,w as n,D as r,k as t};
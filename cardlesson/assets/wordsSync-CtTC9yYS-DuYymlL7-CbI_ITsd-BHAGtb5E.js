const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/wordsCache-ByHSZrui-yaSILgvz-7J9T3Ht2-DT2p5swo.js","assets/wordsCache-BZ4gcfdz-BnHwzGpD-D8q4o8UH-DxsJo8h8.js"])))=>i.map(i=>d[i]);
import{C as e,D as t,E as n,S as r,T as i,c as a,d as o,f as s,h as c,i as l,l as u,t as d,u as f,x as p,y as m}from"./index-Dzohr1b9.js";import{a as h,r as g}from"./wordsCache-BZ4gcfdz-BnHwzGpD-D8q4o8UH-DxsJo8h8.js";import{t as _}from"./Header-BrePaYqJ-CupKeyHn-CUyZQLGM-zp5tyZQ_.js";var v=(e,t=v,n=t.f||=[`assets/wordsCache-ByHSZrui-yaSILgvz-7J9T3Ht2.js`,`assets/wordsCache-BZ4gcfdz-BnHwzGpD-D8q4o8UH.js`])=>e.map(e=>n[e]),y=(e,t=y,n=t.f||=[`assets/wordsCache-ByHSZrui-yaSILgvz.js`,`assets/wordsCache-BZ4gcfdz-BnHwzGpD.js`])=>e.map(e=>n[e]),b=(e,t=b,n=t.f||=[`assets/wordsCache-ByHSZrui.js`,`assets/wordsCache-BZ4gcfdz.js`])=>e.map(e=>n[e]),x={footer:`_footer_1m1ug_1`,exitButton:`_exitButton_1m1ug_8`},S=l(),C=()=>{let{t:e}=n();return(0,S.jsx)(`footer`,{className:x.footer,children:(0,S.jsx)(_,{onClick:async()=>{try{await d(f)}catch(e){console.error(`Ошибка выхода:`,e)}},icon:`pi pi-sign-out`,label:e(`exitAccount`),className:x.exitButton})})},w={cardContainer:`_cardContainer_1rm64_1`,card:`_card_1rm64_1`,cardInner:`_cardInner_1rm64_21`,flipped:`_flipped_1rm64_29`,cardFront:`_cardFront_1rm64_33`,cardBack:`_cardBack_1rm64_34`,word:`_word_1rm64_58`,translations:`_translations_1rm64_64`,translation:`_translation_1rm64_64`,langLabel:`_langLabel_1rm64_77`,translationText:`_translationText_1rm64_83`,actions:`_actions_1rm64_88`,editButton:`_editButton_1rm64_97`,deleteButton:`_deleteButton_1rm64_98`},T=c(),E=({wordKey:e,wordData:t,wordId:r,onEdit:i,onDelete:a,showActions:o=!1})=>{let{t:s,i18n:c}=n(),[l,u]=(0,T.useState)(!1),d=()=>{u(!l)},f,p={};if(t)f=t[c.language||`en`]||``,p=t.translations||{};else if(e){f=s(`words.${e}.${c.language||`en`}`);let t=s(`words.${e}.translations`,{returnObjects:!0});p=typeof t==`object`&&t?t:{}}else f=``;let m=e=>{e.stopPropagation(),r&&t&&i&&i(r,t)},h=e=>{e.stopPropagation(),r&&a&&a(r)};return(0,S.jsxs)(`div`,{className:w.cardContainer,children:[o&&r&&(0,S.jsxs)(`div`,{className:w.actions,onClick:e=>e.stopPropagation(),children:[i&&t&&(0,S.jsx)(`button`,{className:w.editButton,onClick:m,"aria-label":s(`edit`),children:(0,S.jsx)(`i`,{className:`pi pi-pencil`})}),a&&(0,S.jsx)(`button`,{className:w.deleteButton,onClick:h,"aria-label":s(`delete`),children:(0,S.jsx)(`i`,{className:`pi pi-times`})})]}),(0,S.jsx)(`div`,{className:w.card,onClick:d,children:(0,S.jsxs)(`div`,{className:`${w.cardInner} ${l?w.flipped:``}`,children:[(0,S.jsx)(`div`,{className:w.cardFront,children:(0,S.jsx)(`div`,{className:w.word,children:f||e||``})}),(0,S.jsx)(`div`,{className:w.cardBack,children:(0,S.jsx)(`div`,{className:w.translations,children:Object.entries(p).map(([e,t])=>(0,S.jsxs)(`div`,{className:w.translation,children:[(0,S.jsxs)(`span`,{className:w.langLabel,children:[e.toUpperCase(),`:`]}),(0,S.jsx)(`span`,{className:w.translationText,children:t})]},e))})})]})})]})},D=6e4,O=3e5,k=async n=>{if(!f.currentUser||f.currentUser.uid!==n)return null;try{let{loadWordsFromCache:c}=await u(async()=>{let{loadWordsFromCache:e}=await s(async()=>{let{loadWordsFromCache:e}=await r(async()=>{let{loadWordsFromCache:e}=await t(async()=>{let{loadWordsFromCache:e}=await import(`./wordsCache-ByHSZrui-yaSILgvz-7J9T3Ht2-DT2p5swo.js`);return{loadWordsFromCache:e}},__vite__mapDeps([0,1]));return{loadWordsFromCache:e}},v([0,1]));return{loadWordsFromCache:e}},y([0,1]));return{loadWordsFromCache:e}},b([0,1])),l=c(n)||[],d=new Map,f=[];l.forEach(e=>{e.id.startsWith(`temp_`)?f.push(e):d.set(e.id,e)});let h=await p(o(m(i,`words`),a(`userId`,`==`,n),e(`createdAt`,`desc`))),_=new Map;h.forEach(e=>{let t={id:e.id,...e.data()};_.set(e.id,t)});let x=[];return f.forEach(e=>{let t=Array.from(_.values()).find(t=>t.ru===e.ru&&t.en===e.en&&t.ko===e.ko);t?(x.push(t),_.delete(t.id)):x.push(e)}),_.forEach(e=>{x.push(e)}),x.sort((e,t)=>{let n=e.createdAt instanceof Date?e.createdAt.getTime():typeof e.createdAt==`number`?e.createdAt:e.createdAt?new Date(e.createdAt).getTime():0;return(t.createdAt instanceof Date?t.createdAt.getTime():typeof t.createdAt==`number`?t.createdAt:t.createdAt?new Date(t.createdAt).getTime():0)-n}),g(n,x),x}catch(e){return console.error(`Ошибка синхронизации слов с сервером:`,e),null}},A=e=>{try{let t=h(e),n=localStorage.getItem(t);return n?Date.now()-Number.parseInt(n,10)>O:!0}catch(e){return console.error(`Ошибка проверки необходимости синхронизации:`,e),!0}},j=(e,t)=>{let n=null,r=!1,i=async()=>{if(!(r||!f.currentUser||f.currentUser.uid!==e)){r=!0;try{let n=await k(e);n&&t&&t(n)}catch(e){console.error(`Ошибка периодической синхронизации:`,e)}finally{r=!1}}},a=()=>{document.visibilityState===`visible`&&A(e)&&i()},o=()=>{A(e)&&i()};return A(e)&&i(),n=setInterval(()=>{A(e)&&i()},D),document.addEventListener(`visibilitychange`,a),window.addEventListener(`focus`,o),()=>{n&&clearInterval(n),document.removeEventListener(`visibilitychange`,a),window.removeEventListener(`focus`,o)}};export{C as i,j as n,E as r,k as t};